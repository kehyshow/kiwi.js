<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\components\AnimationManager.ts - Kiwi.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Kiwi.js"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.4.9</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AABB.html">AABB</a></li>
            
                <li><a href="../classes/Animation.html">Animation</a></li>
            
                <li><a href="../classes/AnimationManager.html">AnimationManager</a></li>
            
                <li><a href="../classes/ArcadePhysics.html">ArcadePhysics</a></li>
            
                <li><a href="../classes/Audio.html">Audio</a></li>
            
                <li><a href="../classes/AudioLibrary.html">AudioLibrary</a></li>
            
                <li><a href="../classes/AudioManager.html">AudioManager</a></li>
            
                <li><a href="../classes/Back.html">Back</a></li>
            
                <li><a href="../classes/Bar.html">Bar</a></li>
            
                <li><a href="../classes/BasicScore.html">BasicScore</a></li>
            
                <li><a href="../classes/Bootstrap.html">Bootstrap</a></li>
            
                <li><a href="../classes/Bounce.html">Bounce</a></li>
            
                <li><a href="../classes/Box.html">Box</a></li>
            
                <li><a href="../classes/Browser.html">Browser</a></li>
            
                <li><a href="../classes/Button.html">Button</a></li>
            
                <li><a href="../classes/Camera.html">Camera</a></li>
            
                <li><a href="../classes/CameraManager.html">CameraManager</a></li>
            
                <li><a href="../classes/Canvas.html">Canvas</a></li>
            
                <li><a href="../classes/CanvasRenderer.html">CanvasRenderer</a></li>
            
                <li><a href="../classes/Circle.html">Circle</a></li>
            
                <li><a href="../classes/Circular.html">Circular</a></li>
            
                <li><a href="../classes/Clock.html">Clock</a></li>
            
                <li><a href="../classes/ClockManager.html">ClockManager</a></li>
            
                <li><a href="../classes/Common.html">Common</a></li>
            
                <li><a href="../classes/Component.html">Component</a></li>
            
                <li><a href="../classes/ComponentManager.html">ComponentManager</a></li>
            
                <li><a href="../classes/Counter.html">Counter</a></li>
            
                <li><a href="../classes/Cubic.html">Cubic</a></li>
            
                <li><a href="../classes/DataLibrary.html">DataLibrary</a></li>
            
                <li><a href="../classes/Device.html">Device</a></li>
            
                <li><a href="../classes/Elastic.html">Elastic</a></li>
            
                <li><a href="../classes/Entity.html">Entity</a></li>
            
                <li><a href="../classes/Exponential.html">Exponential</a></li>
            
                <li><a href="../classes/File.html">File</a></li>
            
                <li><a href="../classes/FileStore.html">FileStore</a></li>
            
                <li><a href="../classes/Finger.html">Finger</a></li>
            
                <li><a href="../classes/Game.html">Game</a></li>
            
                <li><a href="../classes/GameManager.html">GameManager</a></li>
            
                <li><a href="../classes/GameMath.html">GameMath</a></li>
            
                <li><a href="../classes/GLArrayBuffer.html">GLArrayBuffer</a></li>
            
                <li><a href="../classes/GLElementArrayBuffer.html">GLElementArrayBuffer</a></li>
            
                <li><a href="../classes/GLRenderer.html">GLRenderer</a></li>
            
                <li><a href="../classes/GLShaders.html">GLShaders</a></li>
            
                <li><a href="../classes/GLTexture.html">GLTexture</a></li>
            
                <li><a href="../classes/Group.html">Group</a></li>
            
                <li><a href="../classes/HUDDisplay.html">HUDDisplay</a></li>
            
                <li><a href="../classes/HUDManager.html">HUDManager</a></li>
            
                <li><a href="../classes/HUDWidget.html">HUDWidget</a></li>
            
                <li><a href="../classes/IChild.html">IChild</a></li>
            
                <li><a href="../classes/Icon.html">Icon</a></li>
            
                <li><a href="../classes/IconBar.html">IconBar</a></li>
            
                <li><a href="../classes/Input.html">Input</a></li>
            
                <li><a href="../classes/InputManager.html">InputManager</a></li>
            
                <li><a href="../classes/Intersect.html">Intersect</a></li>
            
                <li><a href="../classes/IntersectResult.html">IntersectResult</a></li>
            
                <li><a href="../classes/Key.html">Key</a></li>
            
                <li><a href="../classes/Keyboard.html">Keyboard</a></li>
            
                <li><a href="../classes/Keycodes.html">Keycodes</a></li>
            
                <li><a href="../classes/Line.html">Line</a></li>
            
                <li><a href="../classes/Linear.html">Linear</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/MasterClock.html">MasterClock</a></li>
            
                <li><a href="../classes/Matrix.html">Matrix</a></li>
            
                <li><a href="../classes/Menu.html">Menu</a></li>
            
                <li><a href="../classes/MenuItem.html">MenuItem</a></li>
            
                <li><a href="../classes/Mouse.html">Mouse</a></li>
            
                <li><a href="../classes/MouseCursor.html">MouseCursor</a></li>
            
                <li><a href="../classes/Point.html">Point</a></li>
            
                <li><a href="../classes/Pointer.html">Pointer</a></li>
            
                <li><a href="../classes/Quadratic.html">Quadratic</a></li>
            
                <li><a href="../classes/Quartic.html">Quartic</a></li>
            
                <li><a href="../classes/Quintic.html">Quintic</a></li>
            
                <li><a href="../classes/RandomDataGenerator.html">RandomDataGenerator</a></li>
            
                <li><a href="../classes/Ray.html">Ray</a></li>
            
                <li><a href="../classes/Rectangle.html">Rectangle</a></li>
            
                <li><a href="../classes/RequestAnimationFrame.html">RequestAnimationFrame</a></li>
            
                <li><a href="../classes/Sequence.html">Sequence</a></li>
            
                <li><a href="../classes/Signal.html">Signal</a></li>
            
                <li><a href="../classes/SignalBinding.html">SignalBinding</a></li>
            
                <li><a href="../classes/SingleImage.html">SingleImage</a></li>
            
                <li><a href="../classes/Sinusoidal.html">Sinusoidal</a></li>
            
                <li><a href="../classes/Sound.html">Sound</a></li>
            
                <li><a href="../classes/Sprite.html">Sprite</a></li>
            
                <li><a href="../classes/SpriteSheet.html">SpriteSheet</a></li>
            
                <li><a href="../classes/Stage.html">Stage</a></li>
            
                <li><a href="../classes/State.html">State</a></li>
            
                <li><a href="../classes/StateConfig.html">StateConfig</a></li>
            
                <li><a href="../classes/StateManager.html">StateManager</a></li>
            
                <li><a href="../classes/StaticImage.html">StaticImage</a></li>
            
                <li><a href="../classes/Textfield.html">Textfield</a></li>
            
                <li><a href="../classes/TextField.html">TextField</a></li>
            
                <li><a href="../classes/TextureAtlas.html">TextureAtlas</a></li>
            
                <li><a href="../classes/TextureLibrary.html">TextureLibrary</a></li>
            
                <li><a href="../classes/Tile.html">Tile</a></li>
            
                <li><a href="../classes/TileMap.html">TileMap</a></li>
            
                <li><a href="../classes/TileMapLayer.html">TileMapLayer</a></li>
            
                <li><a href="../classes/TileType.html">TileType</a></li>
            
                <li><a href="../classes/Time.html">Time</a></li>
            
                <li><a href="../classes/Timer.html">Timer</a></li>
            
                <li><a href="../classes/TimerEvent.html">TimerEvent</a></li>
            
                <li><a href="../classes/Touch.html">Touch</a></li>
            
                <li><a href="../classes/Transform.html">Transform</a></li>
            
                <li><a href="../classes/Tween.html">Tween</a></li>
            
                <li><a href="../classes/TweenManager.html">TweenManager</a></li>
            
                <li><a href="../classes/Vector2.html">Vector2</a></li>
            
                <li><a href="../classes/WidgetInput.html">WidgetInput</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Animations.html">Animations</a></li>
            
                <li><a href="../modules/Components.html">Components</a></li>
            
                <li><a href="../modules/Easing.html">Easing</a></li>
            
                <li><a href="../modules/Files.html">Files</a></li>
            
                <li><a href="../modules/GameObjects.html">GameObjects</a></li>
            
                <li><a href="../modules/Geom.html">Geom</a></li>
            
                <li><a href="../modules/HUD.html">HUD</a></li>
            
                <li><a href="../modules/HUDComponents.html">HUDComponents</a></li>
            
                <li><a href="../modules/Input.html">Input</a></li>
            
                <li><a href="../modules/Kiwi.html">Kiwi</a></li>
            
                <li><a href="../modules/Renderers.html">Renderers</a></li>
            
                <li><a href="../modules/Sound.html">Sound</a></li>
            
                <li><a href="../modules/System.html">System</a></li>
            
                <li><a href="../modules/Textures.html">Textures</a></li>
            
                <li><a href="../modules/Tilemap.html">Tilemap</a></li>
            
                <li><a href="../modules/Time.html">Time</a></li>
            
                <li><a href="../modules/Tweens.html">Tweens</a></li>
            
                <li><a href="../modules/Utils.html">Utils</a></li>
            
                <li><a href="../modules/Widget.html">Widget</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\components\AnimationManager.ts</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
* Component&#x27;s are a snipnets of code which are designed to provide extra functionality to various objects, such as IChild&#x27;s/GameObjects/HUDWidgets/e.t.c. The code that components have are not necessarily needed for an object to work, but are instead provided to make common task&#x27;s that you would do with those objects easier. An Example being that at times you may like to make a GameObject draggable by the user and so you can then add Input Component and execute the enableDrag on that GameObject. That would be task that not every GameObject would need, but only specific ones. 
*  
* @module Kiwi
* @submodule Components 
* @main Components
*/ 
 
module Kiwi.Components {

    /**
    * The AnimationManager is used to handle the creation and playment of Animations on a individual GameObject based on the TextureAtlas it has. 
    * When the AnimationManager is instantiated it will loop through all of the Sequences on the TextureAtlas of the GameObject being used and will create a new Animation for each one.
    * Now when you create a new Animation that animation will automatically be added as a new Sequence to the corresponding Texture. 
    * This way you don&#x27;t need to create new Animations for a each Sprite that use&#x27;s the same Texture.
    *
    * @class AnimationManager
    * @extends Component
    * @constructor
    * @param entity {Entity} The entity that this animation component belongs to.
    * @return {AnimationManager}
    */
    export class AnimationManager extends Component {
         
        constructor(entity: Kiwi.Entity) {
            super(entity, &#x27;Animation&#x27;);

            //get the entity and the animation.
            this.entity = entity;
            this._atlas = this.entity.atlas; 
            this._animations = {};

            //create all of the default animations.
            for (var i = 0; i &lt; this._atlas.sequences.length; i++) {
                this.createFromSequence(this._atlas.sequences[i], false);
            }

            //if a default animation already exists
            if (this._animations[&#x27;default&#x27;]) {
                this.currentAnimation = this._animations[&#x27;default&#x27;];
            //otherwise create one.
            } else {
                var defaultCells = [];
                for (var i = 0; i &lt; this._atlas.cells.length; i++) {
                    defaultCells.push(i);
                }
                this.currentAnimation = this.add(&#x27;default&#x27;, defaultCells, 0.1, true, false);
            }
        }

        /**
        * The entity that this animation belongs to.
        * @property entity
        * @type Entity
        * @private
        */
        private entity: Kiwi.Entity;

        /**
        * The texture atlas that this animation is taking affect on.
        * @property _atlas
        * @type TextureAtlas
        * @private
        */
        private _atlas: Kiwi.Textures.TextureAtlas;
        
        /**
        * A dictionary containing all of the animations that are avaiable.
        * @property _animations
        * @type Object
        * @private
        */
        private _animations: {};

        /**
        * A reference to the animation that is currently being played.
        * @property _currentAnimation
        * @type Animation
        * @default null
        * @private
        */
        public currentAnimation: Kiwi.Animations.Animation = null;

        /**
        * Indicates whether or not this animation is currently playing or not.
        * @property _isPlaying
        * @type boolean
        * @default false
        * @private
        */
        private _isPlaying: boolean = false;
        
        /**
        * Returns a boolean indicating whether or not the current animation is playing. This is READ ONLY.
        * @property isPlaying
        * @type boolean
        * @public
        */
        public get isPlaying(): boolean {
            return this._isPlaying;
        }
        
        /**
        * The type of object that this is.
        * @method objType
        * @type string
        * @public
        */
        public objType() {
            return &quot;AnimationManager&quot;;
        }

        /**
        * Creates a new sequence and then adds that sequence as a new animation on this component. Returns that animation that was created.
        *
        * @method add
        * @param {string} name
        * @param cells {number[]} An array that contains a reference to the cells that are to be played in the animation. 
        * @param speed {number} The amount of time that each frame should stay on screen for. In seconds.
        * @param [loop=false] {boolean} If when the animation reaches the last frame, it should go back to the start again.
        * @param [play=false] {boolean} If once created the animation should play right away.
        * @return {Animation} The Anim that was created.
        * @public
        */
        public add(name: string, cells: number[], speed: number, loop: boolean= false, play: boolean= false): Kiwi.Animations.Animation {
            var newSequence = new Kiwi.Animations.Sequence(name, cells, speed, loop);
            this._atlas.sequences.push(newSequence);
            
            return this.createFromSequence(newSequence, play);
        }

        /**
        * Creates a new animation based on a sequence that is passed. 
        *
        * @method createFromSequence
        * @param sequence {Kiwi.Sequence} The sequence that the animation is based on.
        * @param [play=false] {boolean} If the animation should play once it has been created
        * @return {Animation} The Anim that was created.
        * @public
        */
        public createFromSequence(sequence: Kiwi.Animations.Sequence, play: boolean= false): Kiwi.Animations.Animation {
            this._animations[sequence.name] = new Kiwi.Animations.Animation(sequence.name, sequence, this.entity.clock);

            if (play) this.play(sequence.name);
            
            return this._animations[sequence.name];
        }

        /**
        * Plays either the current animation or the name of the animation that you pass.
        * 
        * @method play
        * @param [name] {string} The name of the animation that you want to play. If not passed it plays the current animation.
        * @public
        */
        public play(name: string = this.currentAnimation.name): Kiwi.Animations.Animation {

            return this._play(name);
        }
        
        /**
        * Play an animation at a particular frameIndex. 
        * 
        * @method playAt
        * @param index {Number} The index of the frame in the Sequence that you would like to play.
        * @param [name] {String} The name of the animation that you want to play. If not passed, it plays it on the current animation.
        * @public
        */
        public playAt(index: number, name: string = this.currentAnimation.name): Kiwi.Animations.Animation {
            
            return this._play(name, index);
        } 

        /**
        * An internal method used to actually play the animation.
        * 
        * @method _play
        * @param name {number} The name of the animation that is to be switched to.
        * @param [index=null] {string} The index of the frame in the Sequence that is to play.
        * @return {Animation}
        * @private
        */
        private _play(name: string, index: number=null): Kiwi.Animations.Animation {
            
            this._isPlaying = true;
            this._setCurrentAnimation(name); 
            
            if (index !== null)
                this.currentAnimation.playAt(index);
            else
                this.currentAnimation.play();
            
            this._setCellIndex();

            return this.currentAnimation;
        }

        /**
        * Stops the current animation from playing.
        * @method stop
        * @public
        */
        public stop() {
            if (this.isPlaying === true) {
                this.currentAnimation.stop();
            }
            this._isPlaying = false;
        }

        /**
        * Pauses the current animation.
        * @method pause
        * @public
        */ 
        public pause() {
            this.currentAnimation.pause();
            this._isPlaying = false;
        }

        /**
        * Resumes the current animation. The animation should have already been paused.
        * @method resume
        * @public
        */
        public resume() {
            this.currentAnimation.resume();
            this._isPlaying = true;
        }

        /**
        * Either switchs to a particular animation or a particular frame in an animation depending on if you pass a string or a number. 
        * You can also force the animation to play or to stop by passing a boolean in. But if left as null, the animation will base it off what is currently happening.
        * So if the animation is currently &#x27;playing&#x27; then once switched to the animation will play. If not currently playing it will switch to and stop.
        *
        * @method switchTo
        * @param val {string|number}
        * @param [play=null] {boolean} Force the animation to play or stop. If null the animation base&#x27;s it off what is currently happening.
        * @public
        */
        public switchTo(val: any, play:boolean=null) { 
            switch (typeof val) {
                case &quot;string&quot;:
                    if (this.currentAnimation.name !== val) {
                        this._setCurrentAnimation(val);
                    }
                    break;
                case &quot;number&quot;:
                    this.currentAnimation.frameIndex = val;
                    break;
            }

            if (play || play === null &amp;&amp; this.isPlaying) this.play();
            if (play == false &amp;&amp; this.isPlaying) this.stop();

            this._setCellIndex();
        }

        /**
        * Makes the current animation go to the next frame. If the animation is at the end of the sequence it then goes back to the start.
        * @method nextFrame
        * @public
        */
        public nextFrame() {
            this.currentAnimation.nextFrame();
            this._setCellIndex();
        }
        
        /**
        * Makes the current animation go to the prev frame. If the animation is at the start, the animation will go the end of the sequence.
        * @method prevFrame
        * @public
        */
        public prevFrame() {
            this.currentAnimation.prevFrame();
            this._setCellIndex();
        }

        /**
        * Internal method that sets the current animation to the animation passed.
        *
        * @method _setCurrentAnimation
        * @param {string} name
        * @private
        */
        private _setCurrentAnimation(name: string) {

            if (this.currentAnimation !== null) this.currentAnimation.stop();
            if (this._animations[name]) {
                this.currentAnimation = this._animations[name]; 
            }  
        }

        /**
        * The update loop, it only updates the currentAnimation and only if it is playing.
        * @method update 
        * @public
        */
        public update() { 
            if (this.currentAnimation &amp;&amp; this.isPlaying) {
                if (this.currentAnimation.update()) {
                    this._setCellIndex();
                }
            }
        }
        
        /**
        * Gets the cell that the current animation is current at. This is READ ONLY.
        * @property currentCell
        * @type number
        * @public
        */
        public get currentCell():number {
            return this.currentAnimation.currentCell;
        }

        /**
        * Gets the current frame index of the cell in the sequence that is currently playing. This is READ ONLY.
        * @property frameIndex 
        * @type number
        * @public
        */
        public get frameIndex():number {
            return this.currentAnimation.frameIndex;
        }

        /**
        * Returns the length (Number of cells) of the current animation that is playing. This is READ ONLY.
        * @property length
        * @type number
        * @public
        */
        public get length(): number {
            return this.currentAnimation.length;
        }

        /**
        * Get a animation that is on the animation component. 
        * 
        * @method getAnimation
        * @param {string} name
        * @return {Animation} 
        * @public
        */
        public getAnimation(name: string): Kiwi.Animations.Animation {
            return this._animations[name];
        }
        
        /**
        * An internal method that is used to set the cell index of the entity. This is how the animation changes.
        * @method _setCellIndex
        * @private
        */
        private _setCellIndex() {
            this.entity.cellIndex = this.currentCell;
        }

	    /**
	    * Returns a string representation of this object.
	    * @method toString
	    * @return {string} A string representation of this object.
        * @public
	    */
        public toString(): string {

            return &#x27;[{Animation (x=&#x27; + this.active + &#x27;)}]&#x27;;

        }

        /**
        * Destroys the animation component and runs the destroy on all of the anims that it has.
        * @method destroy
        * @public
        */
        public destroy() {
            this._isPlaying = false;
            super.destroy();

            for (var key in this._animations) {
                this._animations[key].destroy();
                delete this._animations[key];
            }
            delete this._animations;
            delete this.currentAnimation;
            delete this._atlas;
        }

    }

}



    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
