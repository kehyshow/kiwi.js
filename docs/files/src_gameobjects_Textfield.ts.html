<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\gameobjects\Textfield.ts - Kiwi.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Kiwi.js"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.4.9</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AABB.html">AABB</a></li>
            
                <li><a href="../classes/Anim.html">Anim</a></li>
            
                <li><a href="../classes/Animation.html">Animation</a></li>
            
                <li><a href="../classes/ArcadePhysics.html">ArcadePhysics</a></li>
            
                <li><a href="../classes/Audio.html">Audio</a></li>
            
                <li><a href="../classes/AudioLibrary.html">AudioLibrary</a></li>
            
                <li><a href="../classes/AudioManager.html">AudioManager</a></li>
            
                <li><a href="../classes/Back.html">Back</a></li>
            
                <li><a href="../classes/BasicScore.html">BasicScore</a></li>
            
                <li><a href="../classes/Bootstrap.html">Bootstrap</a></li>
            
                <li><a href="../classes/Bounce.html">Bounce</a></li>
            
                <li><a href="../classes/Box.html">Box</a></li>
            
                <li><a href="../classes/Browser.html">Browser</a></li>
            
                <li><a href="../classes/Button.html">Button</a></li>
            
                <li><a href="../classes/Camera.html">Camera</a></li>
            
                <li><a href="../classes/CameraManager.html">CameraManager</a></li>
            
                <li><a href="../classes/Canvas.html">Canvas</a></li>
            
                <li><a href="../classes/CanvasRenderer.html">CanvasRenderer</a></li>
            
                <li><a href="../classes/Circle.html">Circle</a></li>
            
                <li><a href="../classes/Circular.html">Circular</a></li>
            
                <li><a href="../classes/Clock.html">Clock</a></li>
            
                <li><a href="../classes/Common.html">Common</a></li>
            
                <li><a href="../classes/Component.html">Component</a></li>
            
                <li><a href="../classes/ComponentManager.html">ComponentManager</a></li>
            
                <li><a href="../classes/Counter.html">Counter</a></li>
            
                <li><a href="../classes/Cubic.html">Cubic</a></li>
            
                <li><a href="../classes/DataLibrary.html">DataLibrary</a></li>
            
                <li><a href="../classes/Device.html">Device</a></li>
            
                <li><a href="../classes/Elastic.html">Elastic</a></li>
            
                <li><a href="../classes/Entity.html">Entity</a></li>
            
                <li><a href="../classes/Exponential.html">Exponential</a></li>
            
                <li><a href="../classes/File.html">File</a></li>
            
                <li><a href="../classes/FileStore.html">FileStore</a></li>
            
                <li><a href="../classes/Finger.html">Finger</a></li>
            
                <li><a href="../classes/Game.html">Game</a></li>
            
                <li><a href="../classes/GameManager.html">GameManager</a></li>
            
                <li><a href="../classes/GameMath.html">GameMath</a></li>
            
                <li><a href="../classes/GLArrayBuffer.html">GLArrayBuffer</a></li>
            
                <li><a href="../classes/GLElementArrayBuffer.html">GLElementArrayBuffer</a></li>
            
                <li><a href="../classes/GLRenderer.html">GLRenderer</a></li>
            
                <li><a href="../classes/GLShaders.html">GLShaders</a></li>
            
                <li><a href="../classes/GLTexture.html">GLTexture</a></li>
            
                <li><a href="../classes/Group.html">Group</a></li>
            
                <li><a href="../classes/HUDDisplay.html">HUDDisplay</a></li>
            
                <li><a href="../classes/HUDManager.html">HUDManager</a></li>
            
                <li><a href="../classes/HUDWidget.html">HUDWidget</a></li>
            
                <li><a href="../classes/IChild.html">IChild</a></li>
            
                <li><a href="../classes/Icon.html">Icon</a></li>
            
                <li><a href="../classes/IconCounter.html">IconCounter</a></li>
            
                <li><a href="../classes/Input.html">Input</a></li>
            
                <li><a href="../classes/Intersect.html">Intersect</a></li>
            
                <li><a href="../classes/IntersectResult.html">IntersectResult</a></li>
            
                <li><a href="../classes/Key.html">Key</a></li>
            
                <li><a href="../classes/Keyboard.html">Keyboard</a></li>
            
                <li><a href="../classes/Keycodes.html">Keycodes</a></li>
            
                <li><a href="../classes/Line.html">Line</a></li>
            
                <li><a href="../classes/Linear.html">Linear</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Manager.html">Manager</a></li>
            
                <li><a href="../classes/MasterClock.html">MasterClock</a></li>
            
                <li><a href="../classes/Matrix.html">Matrix</a></li>
            
                <li><a href="../classes/Menu.html">Menu</a></li>
            
                <li><a href="../classes/MenuItem.html">MenuItem</a></li>
            
                <li><a href="../classes/Mouse.html">Mouse</a></li>
            
                <li><a href="../classes/MouseCursor.html">MouseCursor</a></li>
            
                <li><a href="../classes/Point.html">Point</a></li>
            
                <li><a href="../classes/Pointer.html">Pointer</a></li>
            
                <li><a href="../classes/Quadratic.html">Quadratic</a></li>
            
                <li><a href="../classes/Quartic.html">Quartic</a></li>
            
                <li><a href="../classes/Quintic.html">Quintic</a></li>
            
                <li><a href="../classes/RandomDataGenerator.html">RandomDataGenerator</a></li>
            
                <li><a href="../classes/Range.html">Range</a></li>
            
                <li><a href="../classes/Ray.html">Ray</a></li>
            
                <li><a href="../classes/Rectangle.html">Rectangle</a></li>
            
                <li><a href="../classes/RequestAnimationFrame.html">RequestAnimationFrame</a></li>
            
                <li><a href="../classes/Sequence.html">Sequence</a></li>
            
                <li><a href="../classes/Signal.html">Signal</a></li>
            
                <li><a href="../classes/SignalBinding.html">SignalBinding</a></li>
            
                <li><a href="../classes/SingleImage.html">SingleImage</a></li>
            
                <li><a href="../classes/Sinusoidal.html">Sinusoidal</a></li>
            
                <li><a href="../classes/Sound.html">Sound</a></li>
            
                <li><a href="../classes/Sprite.html">Sprite</a></li>
            
                <li><a href="../classes/SpriteSheet.html">SpriteSheet</a></li>
            
                <li><a href="../classes/Stage.html">Stage</a></li>
            
                <li><a href="../classes/State.html">State</a></li>
            
                <li><a href="../classes/StateConfig.html">StateConfig</a></li>
            
                <li><a href="../classes/StateManager.html">StateManager</a></li>
            
                <li><a href="../classes/StaticImage.html">StaticImage</a></li>
            
                <li><a href="../classes/Textfield.html">Textfield</a></li>
            
                <li><a href="../classes/TextureAtlas.html">TextureAtlas</a></li>
            
                <li><a href="../classes/TextureLibrary.html">TextureLibrary</a></li>
            
                <li><a href="../classes/Tile.html">Tile</a></li>
            
                <li><a href="../classes/TileMap.html">TileMap</a></li>
            
                <li><a href="../classes/TileMapLayer.html">TileMapLayer</a></li>
            
                <li><a href="../classes/TileType.html">TileType</a></li>
            
                <li><a href="../classes/Time.html">Time</a></li>
            
                <li><a href="../classes/Timer.html">Timer</a></li>
            
                <li><a href="../classes/TimerEvent.html">TimerEvent</a></li>
            
                <li><a href="../classes/Touch.html">Touch</a></li>
            
                <li><a href="../classes/Transform.html">Transform</a></li>
            
                <li><a href="../classes/Tween.html">Tween</a></li>
            
                <li><a href="../classes/Vector2.html">Vector2</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Animation.html">Animation</a></li>
            
                <li><a href="../modules/Components.html">Components</a></li>
            
                <li><a href="../modules/Easing.html">Easing</a></li>
            
                <li><a href="../modules/Files.html">Files</a></li>
            
                <li><a href="../modules/GameObjects.html">GameObjects</a></li>
            
                <li><a href="../modules/Geom.html">Geom</a></li>
            
                <li><a href="../modules/HUD.html">HUD</a></li>
            
                <li><a href="../modules/Input.html">Input</a></li>
            
                <li><a href="../modules/Kiwi.html">Kiwi</a></li>
            
                <li><a href="../modules/Renderers.html">Renderers</a></li>
            
                <li><a href="../modules/Sound.html">Sound</a></li>
            
                <li><a href="../modules/System.html">System</a></li>
            
                <li><a href="../modules/Textures.html">Textures</a></li>
            
                <li><a href="../modules/Tilemap.html">Tilemap</a></li>
            
                <li><a href="../modules/Time.html">Time</a></li>
            
                <li><a href="../modules/Tweens.html">Tweens</a></li>
            
                <li><a href="../modules/Utils.html">Utils</a></li>
            
                <li><a href="../modules/Widget.html">Widget</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\gameobjects\Textfield.ts</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
* Kiwi - GameObjects
* @module Kiwi
* @submodule GameObjects 
* 
*/ 
 
module Kiwi.GameObjects {
    
    /**
    *
    *
    * @class Textfield
    * @extends Entity
    */
    export class Textfield extends Kiwi.Entity {

        /**
        * 
        * @constructor
        * @param state {State} The state that this Textfield belongs to
        * @param text {String} The text that is contained within this textfield.
        * @param [x=0] {Number} The new x coordinate from the Position component
        * @param [y=0] {Number} The new y coordinate from the Position component
        * @param [color=&#x27;#000000&#x27;] {String} The color of the text. 
        * @param [size=32] {Number} The size of the text in pixels.
        * @param [weight=&#x27;normal&#x27;] {String} The weight of the text.
        * @param [fontFamily=&#x27;sans-serif&#x27;] {String} The font family that is to be used when rendering.
        * @return {Textfield} This Game Object.
        */
        constructor(state: Kiwi.State, text: string, x: number = 0, y: number = 0, color: string = &#x27;#000000&#x27;, size: number = 32, weight: string = &#x27;normal&#x27;, fontFamily: string = &#x27;sans-serif&#x27;) {

            super(state, x,y);

            this._text = text;
            this._fontWeight = weight;
            this._fontSize = size;
            this._fontColor = color;
            this._fontFamily = fontFamily;
            this._textAlign = &#x27;left&#x27;;
            this._baseline = &#x27;top&#x27;;
            
            this.dirty = true;
        }

        /**
        * Returns the type of object that this is
        * @method objType
        * @return {string}
        * @public
        */
        public objType() {
            return &quot;Textfield&quot;;
        }

        /**
        * The text that is to be rendered.
        * @property _text
        * @type string
        * @private
        */
        private _text: string;
        
        /**
        * The weight of the font.
        * @property _fontWeight
        * @type string
        * @default &#x27;normal&#x27;
        * @private
        */
        private _fontWeight: string;

        /**
        * The size of the font.
        * @property _fontSize
        * @type number
        * @default 32
        * @private
        */
        private _fontSize: number;

        /**
        * The color of the text.
        * @property _fontColor
        * @type string
        * @default &#x27;#000000&#x27;
        * @private
        */
        private _fontColor: string;

        /**
        * The font family that is to be rendered.
        * @property _fontFamily
        * @type string
        * @default &#x27;sans-serif&#x27;
        * @private
        */
        private _fontFamily: string;

        /**
        * The alignment of the text. This can either be &#x27;left&#x27;, &#x27;right&#x27; or &#x27;center&#x27;
        * @property _textAlign
        * @type string
        * @default &#x27;center&#x27;
        * @private
        */
        private _textAlign: string;

        /**
        * The baseline of the text to be rendered.
        * @property _baseline
        * @type string
        * @private
        */
        private _baseline: string; 

        /**
        * The text that you would like to appear in this textfield.
        * @property text
        * @type string
        * @public
        */
        public set text(value: string) {
            this._text = value;
            this.dirty = true;
        } 
        public get text(): string {
            return this._text;
        }

        /**
        * The color of the font that is contained in this textfield.
        * @property color
        * @type string
        * @public
        */
        public set color(val: string) {
            this._fontColor = val;
            this.dirty = true;
        } 
        public get color(): string {
            return this._fontColor;
        }

        /**
        * The weight of the font.
        * @property fontWeight
        * @type string
        * @public
        */
        public set fontWeight(val: string) {
            this._fontWeight = val;
            this.dirty = true;
        }
        public get fontWeight(): string {
            return this._fontWeight;
        }

        /**
        * The size on font when being displayed onscreen.
        * @property fontSize
        * @type number
        * @public
        */
        public set fontSize(val: number) {
            this._fontSize = val;
            this.dirty = true;
        } 
        public get fontSize(): number {
            return this._fontSize;
        }

        /**
        * The font family that is being used to render the text.
        * @property fontFamily 
        * @type string
        * @public
        */
        public set fontFamily(val: string) {
            this._fontFamily = val;
            this.dirty = true;
        } 
        public get fontFamily(): string {
            return this._fontFamily;
        }
        
        /**
        * A static property that contains the string to center align the text.
        * @property TEXT_ALIGN_CENTER
        * @type string
        * @static
        * @final
        * @public
        */
        public static TEXT_ALIGN_CENTER: string = &#x27;center&#x27;;
        
        /**
        * A static property that contains the string to right align the text.
        * @property TEXT_ALIGN_RIGHT
        * @type string
        * @static
        * @final
        * @public
        */
        public static TEXT_ALIGN_RIGHT: string = &#x27;right&#x27;;
        
        /**
        * A static property that contains the string to left align the text.
        * @property TEXT_ALIGN_LEFT
        * @type string
        * @static
        * @final
        * @public
        */
        public static TEXT_ALIGN_LEFT: string = &#x27;left&#x27;;

        /**
        * Changes the alignment of the text. You can either use the static TEXT_ALIGN constants or pass a string.
        * @type string
        * @public
        */
        public set textAlign(val: string) {
            this._textAlign = val;
            this.dirty = true;
        }
        
        /**
        * Returns a string containing the text alignment for this textfield.
        * @type string
        * @public
        */
        public get textAlign(): string {
            return this._textAlign;
        }

        /**
        * A temporary property that we use to render the actual text to and then get the information from.
        * @property _tempCanvas
        * @type HTMLCanvasElement.
        * @private
        */
        private _tempCanvas: HTMLCanvasElement;

        /**
        * The HTMLImageElement which has the text rendered as an image once the _tempCanvas has generated it. 
        * @property _textImage
        * @type HTMLImageElement
        * @private
        */
        private _textImage: HTMLImageElement;

        /**
        * This method is used to render the text to a off-screen canvas, which is then saved as a HTMLImageElement. 
        * This is so that the canvas doesn&#x27;t render it every frame as it can be costly.
        *
        * @method _renderText
        * @private
        */
        private _renderText() {
            
            //create the canvas
            this._tempCanvas = document.createElement(&#x27;canvas&#x27;);
            var ctxTemp: CanvasRenderingContext2D = this._tempCanvas.getContext(&#x27;2d&#x27;);

            //get/set the width
            ctxTemp.font = this._fontWeight + &#x27; &#x27; + this._fontSize + &#x27;px &#x27; + this._fontFamily;
            var _measurements: TextMetrics = ctxTemp.measureText(this._text);   //when you measure the text for some reason it resets the values?! 
            this._tempCanvas.width = _measurements.width;  
            this._tempCanvas.height = this._fontSize * 1.3; //for the characters that fall below the baseline. Should find better implementation.

            
            //reapply the styles....cause it unapplies after a measurement...?!?
            ctxTemp.font = this._fontWeight + &#x27; &#x27; + this._fontSize + &#x27;px &#x27; + this._fontFamily;
            ctxTemp.fillStyle = this._fontColor;
            ctxTemp.textBaseline = this._baseline;

            //add text
            ctxTemp.fillText(this._text, 0.5, 0.5);

            //create the image
            this._textImage = new Image(this._tempCanvas.width, this._tempCanvas.height);
            this._textImage.src = this._tempCanvas.toDataURL(&quot;image/png&quot;);

            this.dirty = false;
        }
       
        /**
	    * Called by the Layer to which this Game Object is attached
	    * @method render
        * @param {Camera}
        * @public
	    */
        public render(camera:Kiwi.Camera) {
            
            if (this.alpha &gt; 0 &amp;&amp; this.visiblity) {

                //has the text changed at all? 
                if (this.dirty) {
                    this._renderText();
                }
                
                //render on stage
                var ctx: CanvasRenderingContext2D = this.game.stage.ctx;
                ctx.save();

                var t: Kiwi.Geom.Transform = this.transform;

                if (this.alpha &gt; 0 &amp;&amp; this.alpha &lt;= 1) {
                    ctx.globalAlpha = this.alpha;
                }
                
                //align the text
                var x = 0;
                switch (this._textAlign) {
                    case Kiwi.GameObjects.Textfield.TEXT_ALIGN_LEFT:
                        x = 0;
                        break;
                    case Kiwi.GameObjects.Textfield.TEXT_ALIGN_CENTER:
                        x = this._textImage.width / 2;
                        break;
                    case Kiwi.GameObjects.Textfield.TEXT_ALIGN_RIGHT:
                        x = this._textImage.width;
                        break;
                }

                //add the alignment to the transformation
                t.x -= x;
                var m: Kiwi.Geom.Matrix = t.getConcatenatedMatrix();

                ctx.setTransform(m.a, m.b, m.c, m.d, m.tx + t.rotPointX, m.ty + t.rotPointY);
                ctx.drawImage(this._textImage, 0, 0, this._textImage.width, this._textImage.height, -t.rotPointX, -t.rotPointY, this._textImage.width, this._textImage.height);
                
                //remove it again.
                t.x += x;

                ctx.restore();
                
            }
            
        }

    }

}
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
