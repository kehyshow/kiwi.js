<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\geom\Transform.ts - Kiwi.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Kiwi.js"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.4.9</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AABB.html">AABB</a></li>
            
                <li><a href="../classes/Anim.html">Anim</a></li>
            
                <li><a href="../classes/Animation.html">Animation</a></li>
            
                <li><a href="../classes/ArcadePhysics.html">ArcadePhysics</a></li>
            
                <li><a href="../classes/Audio.html">Audio</a></li>
            
                <li><a href="../classes/AudioLibrary.html">AudioLibrary</a></li>
            
                <li><a href="../classes/AudioManager.html">AudioManager</a></li>
            
                <li><a href="../classes/Bootstrap.html">Bootstrap</a></li>
            
                <li><a href="../classes/Box.html">Box</a></li>
            
                <li><a href="../classes/Browser.html">Browser</a></li>
            
                <li><a href="../classes/Camera.html">Camera</a></li>
            
                <li><a href="../classes/CameraManager.html">CameraManager</a></li>
            
                <li><a href="../classes/Canvas.html">Canvas</a></li>
            
                <li><a href="../classes/Circle.html">Circle</a></li>
            
                <li><a href="../classes/Clock.html">Clock</a></li>
            
                <li><a href="../classes/Common.html">Common</a></li>
            
                <li><a href="../classes/Component.html">Component</a></li>
            
                <li><a href="../classes/ComponentManager.html">ComponentManager</a></li>
            
                <li><a href="../classes/DataLibrary.html">DataLibrary</a></li>
            
                <li><a href="../classes/Device.html">Device</a></li>
            
                <li><a href="../classes/Entity.html">Entity</a></li>
            
                <li><a href="../classes/File.html">File</a></li>
            
                <li><a href="../classes/FileStore.html">FileStore</a></li>
            
                <li><a href="../classes/Finger.html">Finger</a></li>
            
                <li><a href="../classes/Game.html">Game</a></li>
            
                <li><a href="../classes/GameManager.html">GameManager</a></li>
            
                <li><a href="../classes/GameMath.html">GameMath</a></li>
            
                <li><a href="../classes/Group.html">Group</a></li>
            
                <li><a href="../classes/IChild.html">IChild</a></li>
            
                <li><a href="../classes/Input.html">Input</a></li>
            
                <li><a href="../classes/Intersect.html">Intersect</a></li>
            
                <li><a href="../classes/IntersectResult.html">IntersectResult</a></li>
            
                <li><a href="../classes/Key.html">Key</a></li>
            
                <li><a href="../classes/Keyboard.html">Keyboard</a></li>
            
                <li><a href="../classes/Keycodes.html">Keycodes</a></li>
            
                <li><a href="../classes/Line.html">Line</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Manager.html">Manager</a></li>
            
                <li><a href="../classes/MasterClock.html">MasterClock</a></li>
            
                <li><a href="../classes/Matrix.html">Matrix</a></li>
            
                <li><a href="../classes/Mouse.html">Mouse</a></li>
            
                <li><a href="../classes/MouseCursor.html">MouseCursor</a></li>
            
                <li><a href="../classes/Point.html">Point</a></li>
            
                <li><a href="../classes/Pointer.html">Pointer</a></li>
            
                <li><a href="../classes/RandomDataGenerator.html">RandomDataGenerator</a></li>
            
                <li><a href="../classes/Ray.html">Ray</a></li>
            
                <li><a href="../classes/Rectangle.html">Rectangle</a></li>
            
                <li><a href="../classes/RequestAnimationFrame.html">RequestAnimationFrame</a></li>
            
                <li><a href="../classes/Sequence.html">Sequence</a></li>
            
                <li><a href="../classes/Signal.html">Signal</a></li>
            
                <li><a href="../classes/SignalBinding.html">SignalBinding</a></li>
            
                <li><a href="../classes/SingleImage.html">SingleImage</a></li>
            
                <li><a href="../classes/Sound.html">Sound</a></li>
            
                <li><a href="../classes/Sprite.html">Sprite</a></li>
            
                <li><a href="../classes/SpriteSheet.html">SpriteSheet</a></li>
            
                <li><a href="../classes/Stage.html">Stage</a></li>
            
                <li><a href="../classes/State.html">State</a></li>
            
                <li><a href="../classes/StateConfig.html">StateConfig</a></li>
            
                <li><a href="../classes/StateManager.html">StateManager</a></li>
            
                <li><a href="../classes/StaticImage.html">StaticImage</a></li>
            
                <li><a href="../classes/Textfield.html">Textfield</a></li>
            
                <li><a href="../classes/TextureAtlas.html">TextureAtlas</a></li>
            
                <li><a href="../classes/TextureLibrary.html">TextureLibrary</a></li>
            
                <li><a href="../classes/Timer.html">Timer</a></li>
            
                <li><a href="../classes/TimerEvent.html">TimerEvent</a></li>
            
                <li><a href="../classes/Touch.html">Touch</a></li>
            
                <li><a href="../classes/Transform.html">Transform</a></li>
            
                <li><a href="../classes/Tween.html">Tween</a></li>
            
                <li><a href="../classes/Vector2.html">Vector2</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Animation.html">Animation</a></li>
            
                <li><a href="../modules/Components.html">Components</a></li>
            
                <li><a href="../modules/Files.html">Files</a></li>
            
                <li><a href="../modules/GameObjects.html">GameObjects</a></li>
            
                <li><a href="../modules/Geom.html">Geom</a></li>
            
                <li><a href="../modules/Input.html">Input</a></li>
            
                <li><a href="../modules/Kiwi.html">Kiwi</a></li>
            
                <li><a href="../modules/Sound.html">Sound</a></li>
            
                <li><a href="../modules/System.html">System</a></li>
            
                <li><a href="../modules/Textures.html">Textures</a></li>
            
                <li><a href="../modules/Time.html">Time</a></li>
            
                <li><a href="../modules/Tweens.html">Tweens</a></li>
            
                <li><a href="../modules/Utils.html">Utils</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\geom\Transform.ts</h1>

<div class="file">
    <pre class="code prettyprint linenums">
ï»¿/**
* Kiwi - Geom
* @module Kiwi
* @submodule Geom
*/

module Kiwi.Geom {

    /**
    * Represents position, scale, rotation and rotationPoint of an Entity.
    * - Values can be transformed with a 3x3 affine transformation matrix, which each transform is assigned.
    * - A tranform can be assigned a parent, which may in turn have it&#x27;s own parent, thereby creating a tranform inheritence heirarchy
    * - A concatenated transformation matrix, representing the combined matrices of the transform and its ancestors.
    *
    * @class Transform
    *
    */
    export class Transform {

        /** 
        * Constructor
        * @param {Number} x. X position of the transform.
        * @param {Number} y. Y position of the transform.
        * @param {Number} scaleX. X scaling of the transform.
        * @param {Number} scaleY. Y scaling of the transform.
        * @param {Number} rotation. Rotation of the transform in radians.
        * @param {Number} rotX. rotationPoint offset on X axis.
        * @param {Number} rotY. rotationPoint offset on Y axis.
        * @return {Kiwi.Geom.Transform} This object.
        */
        constructor(x: number = 0, y: number = 0, scaleX: number = 1, scaleY: number = 1, rotation: number = 0, rotPointX: number = 0, rotPointY: number = 0) {

            this.setTransform(x, y, scaleX, scaleY, rotation, rotPointX, rotPointY);

            this._matrix = new Matrix();

            this._matrix.setFromTransform(this._x, this._y, this._scaleX, this._scaleY, this._rotation);

            this._cachedConcatenatedMatrix = this.getConcatenatedMatrix();

        }

        public objType() {
            return &quot;Transform&quot;;
        }

        /** 
        * X position of the transform
        * @property _x
        * @type Number
        * @private
        **/
        private _x: number = 0;

        /** 
        * Return the X value of the transform.
        * @method x
        * @return {Number} The X value of the transform.
        */
        public set x(value: number) {
            
            this._x = value;

        }

        public get x():number {
            return this._x;
        }

        /** 
        * Y position of the transform
        * @property _y
        * @type Number
        * @private
        **/
        private _y: number = 0;

        /** 
        * Return the Y value of the transform.
        * @method y
        * @return {Number} The Y value of the transform.
        */
        
        public set y(value: number) {
            this._y = value;
        }

        public get y(): number {
            return this._y;
        }


        /** 
        * X scaleof the transform
        * @property _scaleX
        * @type Number
        * @private
        **/
        private _scaleX: number = 1;

        /** 
        * Return the X scale value of the transform.
        * @method scaleX
        * @return {Number} The X value of the transform.
        */
        public set scaleX(value: number) {
            this._scaleX = value;
        }

        public get scaleX(): number {
            return this._scaleX;
        }

        /** 
        * Y scale of the transform
        * @property _scaleY
        * @type Number
        * @private
        **/
        private _scaleY: number = 1;

        /** 
        * Return the Y scale value of the transform.
        * @method scaleY
        * @return {Number} The Y value of the transform.
        */
        public set scaleY(value: number) {
            this._scaleY = value;
        }

        public get scaleY():number {
            return this._scaleY;
        }

        /** 
        * Rotation of the transform in radians.
        * @property _rotation
        * @type Number
        * @private
        **/
        private _rotation: number = 0;

        /** 
        * Return the rotation value of the transform in radians.
        * @method rotation
        * @return {Number} The rotation value of the transform.
        */
        public set rotation(value: number) {
            this._rotation = value;
        }

        public get rotation():number {
            return this._rotation;
        }

        /** 
        * Rotation offset on X axis.
        * @property _rotPointX
        * @type Number
        * @private
        **/
        private _rotPointX: number = 0;

        /** 
        * Return the Rotation value from the x axis.
        * @method rotPointX
        * @return {Number} The registration value from the x axis.
        */
        public set rotPointX(value: number) {
            this._rotPointX = value;
        }

        public get rotPointX(): number {
            return this._rotPointX;
        }

        /** 
        * Rotation offset on Y axis.
        * @property _rotY
        * @type Number
        * @private
        **/
        private _rotPointY: number = 0;

        /** 
        * Return the rotation value from the y axis.
        * @method rotY
        * @return {Number} The rotation value from the y axis.
        */
        public set rotPointY(value: number) {
            this._rotPointY = value;
        }

        public get rotPointY(): number {
            return this._rotPointY;
        }

        /** 
        * A 3x3 transformation matrix object that can be use this tranform to manipulate points or the context transformation.
        * @property _matrix
        * @type Object
        * @protected
        **/
        private _matrix: Matrix;

        /** 
        * Return the Matrix being used by this Transform
        * @method matrix
        * @return {Kiwi.Geom.Matrix} The Matrix being used by this Transform
        */
        public get matrix(): Matrix {

            return this._matrix;

        }

        /** 
        * The most recently calculated matrix from getConcatenatedMatrix.
        * @property _cachedConcatenatedMatrix
        * @type Kiwi.Geom.Matrix
        * @private
        **/
        private _cachedConcatenatedMatrix: Matrix;

        /** 
        * Return the x of this transform translated to world space.
        * @method worldX
        * @return {Number} x coordinate in world space
        */
        public get worldX(): number {

            return this.getConcatenatedMatrix().tx;

        }

        /** 
        * Return the y of this transform translated to world space.
        * @method worldY
        * @return {Number} y coordinate in world space
        */
        public get worldY(): number {

            return this.getConcatenatedMatrix().ty;

        }


        /** 
        * The parent transform. If set to null there is no parent. Otherwise this is used by getConcatenatedMatrix to offset the current transforms by the another matrix
        * @property _parent
        * @type Kiwi.Geom.Transform
        * @private
        **/
        private _parent: Transform;

        /** 
        * Return the parent Transform, if any.
        * @method parent
        * @return {Kiwi.Geom.Transform} The parent Transform, or null.
        */
        
        public set parent(value: Transform) {
            if(!this.checkAncestor(value)) {
                this._parent = value;
            }
        }

        public get parent(): Transform {
            return this._parent;
        }

        /** 
        * Set the X and Y values of the transform.
        * @method setPosition
        * @param {Number} x.
        * @param {Number} y.
        * @return {Kiwi.Geom.Transform} This object.
        */
        public setPosition(x: number, y: number): Transform {

            this._x = x;
            this._y = y;
            //this.owner.dirty = true;

            return this;
        }

        /** 
        * Set the X and Y values of the transform from a point.
        * @method setPositionPoint
        * @param {Kiwi.Geom.Point} point.
        * @return {Kiwi.Geom.Transform} This object.
        */
        public setPositionFromPoint(point: Point): Transform {

            this._x = point.x;
            this._y = point.y;
            //this.owner.dirty = true;

            return this;

        }

        /** 
        * Translate the X and Y value of the transform by point components.
        * @method translatePositionFromPoint
        * @param {Kiwi.Geom.Point} point.
        * @return {Kiwi.Geom.Transform} This object.
        */
        public translatePositionFromPoint(point: Point): Transform {

            this._x += point.x;
            this._y += point.y;
            //this.owner.dirty = true;

            return this;

        }

        /** 
        * Return a Point representing the X and Y values of the transform. If none is given a new Point objected will be created.
        * @method getPostionPoint
        * @return {Kiwi.Geom.Point} A point representing the X and Y values of the transform.
        */
        public getPositionPoint(output: Point = new Kiwi.Geom.Point): Point {

            return output.setTo(this._x, this._y);

        }

        /** 
	    * Set the X and Y scale value of the transform.
	    * @method scale
	    * @param {Number} scaleX.
	    * @param {Number} scaleY.
        * @return {Kiwi.Geom.Transform} This object.
	    */
        public set scale(value:number) {

            this._scaleX = value;
            this._scaleY = value;
            //this.owner.dirty = true;

        }

        /** 
        * Set the core properties of the transform 
        * @method setTransform
        * @param {Number} x. X position of the transform.
        * @param {Number} y. Y position of the transform.
        * @param {Number} scaleX. X scaling of the transform.
        * @param {Number} scaleY. Y scaling of the transform.
        * @param {Number} rotation. Rotation of the transform in radians.
        * @param {Number} rotX. Rotation offset on X axis.
        * @param {Number} rotY. Rotation offset on Y axis.
        * @return {Kiwi.Geom.Transform} This object.
        */
        public setTransform(x: number = 0, y: number = 0, scaleX: number = 1, scaleY: number = 1, rotation: number = 0, rotPointX: number = 0, rotPointY: number = 0): Transform {

            this._x = x;
            this._y = y;
            this._scaleX = scaleX;
            this._scaleY = scaleY;
            this._rotation = rotation;
            this._rotPointX = rotPointX;
            this._rotPointY = rotPointY;

            //if (this.owner)
            //{
            //    this.owner.dirty = true;
            //}

            return this;

        }

        /** 
        * Return the parent matrix of the transform. If there is no parent then null is returned.
        * @method getParentMatrix
        * @return {Kiwi.Geom.Matrix} The parent transform matrix.
        */
        public getParentMatrix(): Matrix {

            if (this._parent)
            {
                return this._parent.getConcatenatedMatrix();
            }

            return null
        }

        /** 
        * Return the transformation matrix that concatenates this transform with all ancestor transforms.
        * If there is no parent then this will return a matrix the same as this transforms matrix.
        * @method getConcatenatedMatrix
        * @return {Kiwi.Geom.Matrix} The concatenated matrix.
        */
        public getConcatenatedMatrix(): Matrix {

            this._matrix.setFromTransform(this._x, this._y, this._scaleX, this._scaleY, this._rotation);

            var parentMatrix = this.getParentMatrix();

            if (parentMatrix)
            {
                var matrix = this._matrix.clone();
                matrix.prependMatrix(parentMatrix);
                this._cachedConcatenatedMatrix.copyFrom(matrix);
                return matrix;
            }

            return this._matrix;

        }

        /** 
        * Return the x of this transform translated to a camera space
        * @method getCameraX
        * @param {Object} the camera 
        * @return (Number) x coordinate in the camera space
        
	    public getCameraX ( camera:Camera ):number
	    {
		    var mat = this.getConcatenatedMatrix();
		    mat.prependMatrix(camera.transform.getConcatenatedMatrix());
   		    return mat.tx;
    	}

        /** 
        * Return the y of this transform translated to a camera space
        * @method getCameraY
        * @param {Object} the camera 
        * @return (Number) y coordinate in the camera space
        	
	    public getCameraY ( camera:Camera ):number
	    {
		    var mat = this.getConcatenatedMatrix();
		    mat.prependMatrix(camera.transform.getConcatenatedMatrix());
   		    return mat.ty;
    	}
        */

        /** 
	     * 
	     * @method transformPoint
         * @param {Kiwi.Geom.Point} point
         * @return {Kiwi.Geom.Point}
	     **/
        public transformPoint(point: Point): Point {

            var mat = this.getConcatenatedMatrix();

            return mat.transformPoint(point);

        }

        /** 
        * Copy another transforms data to this transform. A clone of the source matrix is created for the matrix property.
        * @method copyFrom
        * @param {Kiwi.Geom.Transform} transform. The tranform to be copied from.
        * @return {Kiwi.Geom.Transform} This object.
        */
        public copyFrom(source: Transform): Transform {

            this.setTransform(source.x, source.y, source.scaleX, source.scaleY, source.rotation, source.rotPointX, source.rotPointY);

            this.parent = source.parent;

            //this.owner = source.owner;

            this._matrix = source.matrix.clone();

            return this;

        }

        /** 
	     * Copy this transforms data to the destination Transform. A clone of this transforms matrix is created in the destination Transform Matrix.
	     * @method copyTo
	     * @param {Kiwi.Geom.Transform} transform. The tranform to copy to.
         * @return {Kiwi.Geom.Transform} This object.
	     */
        public copyTo(destination: Transform): Transform {

            destination.copyFrom(this);

            return this;

        }

        /** 
	     * Return a clone of this transform.
	     * @method clone
	     * @param {Kiwi.Geom.Transform} A Transform to copy the clone in to. If none is given a new Transform object will be made.
         * @return {Kiwi.Geom.Transform} A clone of this object.
	     */
        public clone(output: Transform = new Transform()): Transform {

            output.copyFrom(this);

            return output;

        }

        /** 
	     * Recursively check that a transform does not appear as its own ancestor
	     * @method checkAncestor
         * @param {Kiwi.Geom.Transform} The Transform to check.
	     * @return {boolean} Returns true if the given transform is the same as this or an ancestor, otherwise false.
	     */
        public checkAncestor(transform: Transform): boolean {
            
            /*if (transform === this)
            {
                return true
            }

            if (transform.parent !== null)
            {
                return (this.checkAncestor(transform._parent))
            }*/
        
            return false;

        }

        /** 
        * Return a string represention of this object.
        * @method toString
        * @return (string) A string represention of this object.
        */
        public get toString(): string {

            return &quot;[{Transform (x=&quot; + this._x + &quot; y=&quot; + this._y + &quot; scaleX=&quot; + this._scaleX + &quot; scaleY=&quot; + this._scaleY + &quot; rotation=&quot; + this._rotation + &quot; regX=&quot; + this._rotPointX + &quot; regY=&quot; + this.rotPointY + &quot; matrix=&quot; + this._matrix + &quot;)}]&quot;;

        }

    }

}
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
